name: Full CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]
  workflow_dispatch:

jobs:
  frontend:
    name: Frontend CI
    uses: ./.github/workflows/frontend.yml
    secrets:
      VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
      NEXT_PUBLIC_API_URL: ${{ secrets.NEXT_PUBLIC_API_URL }}

  backend:
    name: Backend CI
    uses: ./.github/workflows/backend.yml
    secrets:
      RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
      RENDER_DEPLOY_HOOK_URL: ${{ secrets.RENDER_DEPLOY_HOOK_URL }}

  # 전체 통합 테스트 (향후 추가)
  # integration:
  #   name: Integration Tests
  #   runs-on: ubuntu-latest
  #   needs: [frontend, backend]
  #
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #
  #     - name: Run integration tests
  #       run: |
  #         echo "Integration tests would run here"
